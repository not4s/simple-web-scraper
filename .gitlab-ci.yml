maven-compile:
  stage: build
  script:
    - mvn compile

maven-package:
  stage: build
  script:
    - mvn package

maven-test:
  stage: test
  script:
    - mvn test

kill-previous:
  stage: build
  script:
    - fuser -k -n tcp 5000 # kill existing connections on port 5000/tcp

deploy-app:  
  stage: deploy
  needs:
    - kill-previous
    - maven-package
  script:
    - export PORT=5000
    - sh target/bin/simplewebapp & # run in background
